{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, useCallback, useEffect, useRef, useState } from 'react';\nimport { FormContext } from './FormContext';\nvar defaultMessages = {\n  invalid: 'invalid',\n  required: 'required'\n};\nvar defaultValue = {};\nvar defaultErrors = {};\nvar defaultInfos = {};\n\nvar updateErrors = function updateErrors(nextErrors, name, error) {\n  // we disable no-param-reassing so we can use this as a utility function\n  // to update nextErrors, to avoid code duplication\n\n  /* eslint-disable no-param-reassign */\n  var hasStatusError = typeof error === 'object' && error.status === 'error'; // typeof error === 'object' is implied for both cases of error with\n  // a status message and for an error object that is a react node\n\n  if (typeof error === 'object' && !error.status || hasStatusError || typeof error === 'string') {\n    nextErrors[name] = hasStatusError ? error.message : error;\n  } else {\n    delete nextErrors[name];\n  }\n  /* eslint-enable no-param-reassign */\n\n};\n\nvar updateInfos = function updateInfos(nextInfos, name, error) {\n  /* eslint-disable no-param-reassign */\n  if (typeof error === 'object' && error.status === 'info') {\n    nextInfos[name] = error.message;\n  } else {\n    delete nextInfos[name];\n  }\n  /* eslint-enable no-param-reassign */\n\n};\n\nvar Form = forwardRef(function (_ref, ref) {\n  var children = _ref.children,\n      _ref$errors = _ref.errors,\n      errorsProp = _ref$errors === void 0 ? defaultErrors : _ref$errors,\n      _ref$infos = _ref.infos,\n      infosProp = _ref$infos === void 0 ? defaultInfos : _ref$infos,\n      _ref$messages = _ref.messages,\n      messagesProp = _ref$messages === void 0 ? defaultMessages : _ref$messages,\n      onChange = _ref.onChange,\n      _onReset = _ref.onReset,\n      _onSubmit = _ref.onSubmit,\n      _ref$validate = _ref.validate,\n      validate = _ref$validate === void 0 ? 'submit' : _ref$validate,\n      valueProp = _ref.value,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"children\", \"errors\", \"infos\", \"messages\", \"onChange\", \"onReset\", \"onSubmit\", \"validate\", \"value\"]);\n\n  var _useState = useState(valueProp || defaultValue),\n      value = _useState[0],\n      setValue = _useState[1];\n\n  useEffect(function () {\n    if (valueProp !== undefined && valueProp !== value) {\n      setValue(valueProp);\n    }\n  }, [value, valueProp]);\n\n  var _useState2 = useState(messagesProp),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  useEffect(function () {\n    return setMessages(messagesProp);\n  }, [messagesProp]);\n\n  var _useState3 = useState(errorsProp || {}),\n      errors = _useState3[0],\n      setErrors = _useState3[1];\n\n  useEffect(function () {\n    return setErrors(errorsProp || {});\n  }, [errorsProp]);\n\n  var _useState4 = useState(infosProp || {}),\n      infos = _useState4[0],\n      setInfos = _useState4[1];\n\n  useEffect(function () {\n    return setInfos(infosProp || {});\n  }, [infosProp]);\n\n  var _useState5 = useState({}),\n      touched = _useState5[0],\n      setTouched = _useState5[1];\n\n  var validations = useRef({});\n  useEffect(function () {}, [value, errors, infos]);\n  var update = useCallback(function (name, data, initial) {\n    setValue(function (prevValue) {\n      var nextValue = _extends({}, prevValue);\n\n      nextValue[name] = data; // re-run any validations, in case the validation\n      // is checking across fields\n\n      setErrors(function (prevErrors) {\n        var nextErrors = _extends({}, prevErrors);\n\n        Object.keys(prevErrors).forEach(function (errName) {\n          if (validations.current[errName]) {\n            var nextError = validations.current[errName](data, nextValue);\n            updateErrors(nextErrors, errName, nextError);\n          }\n        });\n        return nextErrors;\n      });\n      setInfos(function (prevInfos) {\n        var nextInfos = _extends({}, prevInfos); // re-run any validations that have infos, in case the validation\n        // is checking across fields\n\n\n        Object.keys(nextInfos).forEach(function (infoName) {\n          if (validations.current[infoName]) {\n            var nextInfo = validations.current[infoName](data, nextValue);\n            updateInfos(nextInfos, infoName, nextInfo);\n          }\n        });\n        return nextInfos;\n      });\n      if (!initial && onChange) onChange(nextValue);\n      return nextValue;\n    });\n    if (!initial) setTouched(function (prevTouched) {\n      var nextTouched = _extends({}, prevTouched);\n\n      nextTouched[name] = true;\n      return nextTouched;\n    });\n  }, [onChange]); // There are three basic models of handling form input value state:\n  //\n  // 1 - form controlled\n  //\n  // In this model, the caller sets `value` and `onChange` propeties\n  // on the Form component to supply the values used by the input fields.\n  // In useFormContext(), componentValue would be undefined and formValue\n  // is be set to whatever the form state has. Whenever the form state\n  // changes, we update the contextValue so the input component will use\n  // that. When the input component changes, we will call update() to\n  // update the form state.\n  //\n  // 2 - input controlled\n  //\n  // In this model, the caller sets `value` and `onChange` properties\n  // on the input components, like TextInput, to supply the value for it.\n  // In useFormContext(), componentValue is this value and we ensure to\n  // update the form state, via update(), and set the contextValue from\n  // the componentValue. When the input component changes, we will\n  // call update() to update the form state.\n  //\n  // 3 - uncontrolled\n  //\n  // In this model, the caller doesn't set a `value` or `onChange` property\n  // at either the form or input component levels.\n  // In useFormContext(), componentValue is undefined and valueProp is\n  // undefined and nothing much happens here. That is, unless the\n  // calling component needs to know the state in order to work, such\n  // as CheckBox or Select. In this case, those components supply\n  // an initialValue, which will trigger updating the contextValue so\n  // they can have access to it.\n  //\n\n  var useFormContext = function useFormContext(name, componentValue, initialValue) {\n    var _useState6 = useState(initialValue),\n        contextValue = _useState6[0],\n        setContextValue = _useState6[1];\n\n    var formValue = name ? value[name] : undefined;\n    useEffect(function () {\n      if (name && componentValue !== undefined && componentValue !== formValue) // input drives\n        update(name, componentValue, formValue === undefined);\n    }, [componentValue, contextValue, formValue, initialValue, name]);\n    var useValue;\n    if (componentValue !== undefined) // input drives\n      useValue = componentValue;else if (valueProp && name && formValue !== undefined) // form drives\n      useValue = formValue;else useValue = contextValue;\n    return [useValue, function (nextValue) {\n      // only set if the input isn't driving\n      if (componentValue === undefined) {\n        if (name) update(name, nextValue);\n        if (initialValue !== undefined) setContextValue(nextValue);\n      }\n    }];\n  };\n\n  return React.createElement(\"form\", _extends({\n    ref: ref\n  }, rest, {\n    onReset: function onReset(event) {\n      if (!valueProp) {\n        setValue(defaultValue);\n        if (onChange) onChange(defaultValue);\n      }\n\n      setErrors({});\n      setTouched({});\n\n      if (_onReset) {\n        event.persist(); // extract from React's synthetic event pool\n\n        var adjustedEvent = event;\n        adjustedEvent.value = defaultValue;\n\n        _onReset(adjustedEvent);\n      }\n    },\n    onSubmit: function onSubmit(event) {\n      // Don't submit the form via browser form action. We don't want it\n      // if the validation fails. And, we assume a javascript action handler\n      // otherwise.\n      event.preventDefault();\n\n      var nextErrors = _extends({}, errors);\n\n      var nextInfos = _extends({}, infos);\n\n      Object.keys(validations.current).forEach(function (name) {\n        var nextError = validations.current[name](value[name], value);\n        updateErrors(nextErrors, name, nextError);\n        updateInfos(nextInfos, name, nextError);\n      });\n      setErrors(nextErrors);\n      setInfos(nextInfos);\n\n      if (Object.keys(nextErrors).length === 0 && _onSubmit) {\n        event.persist(); // extract from React's synthetic event pool\n\n        var adjustedEvent = event;\n        adjustedEvent.value = value;\n        adjustedEvent.touched = touched;\n\n        _onSubmit(adjustedEvent);\n      }\n    }\n  }), React.createElement(FormContext.Provider, {\n    value: {\n      addValidation: function addValidation(name, validation) {\n        validations.current[name] = validation;\n      },\n      removeValidation: function removeValidation(name) {\n        delete validations.current[name];\n      },\n      onBlur: validate === 'blur' ? function (name) {\n        if (validations.current[name]) {\n          var error = validations.current[name](value[name], value);\n          setErrors(function (prevErrors) {\n            var nextErrors = _extends({}, prevErrors);\n\n            updateErrors(nextErrors, name, error);\n            return nextErrors;\n          });\n          setInfos(function (prevInfos) {\n            var nextInfos = _extends({}, prevInfos);\n\n            updateInfos(nextInfos, name, error);\n            return nextInfos;\n          });\n        }\n      } : undefined,\n      errors: errors,\n      get: function get(name) {\n        return value[name];\n      },\n      infos: infos,\n      messages: messages,\n      set: function set(name, nextValue) {\n        return update(name, nextValue);\n      },\n      touched: touched,\n      update: update,\n      useFormContext: useFormContext,\n      value: value\n    }\n  }, children));\n});\nForm.displayName = 'Form';\nvar FormDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  FormDoc = require('./doc').doc(Form); // eslint-disable-line global-require\n}\n\nvar FormWrapper = FormDoc || Form;\nexport { FormWrapper as Form };","map":{"version":3,"sources":["/Users/n/my-app/node_modules/grommet/es6/components/Form/Form.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","useCallback","useEffect","useRef","useState","FormContext","defaultMessages","invalid","required","defaultValue","defaultErrors","defaultInfos","updateErrors","nextErrors","name","error","hasStatusError","status","message","updateInfos","nextInfos","Form","_ref","ref","children","_ref$errors","errors","errorsProp","_ref$infos","infos","infosProp","_ref$messages","messages","messagesProp","onChange","_onReset","onReset","_onSubmit","onSubmit","_ref$validate","validate","valueProp","value","rest","_useState","setValue","undefined","_useState2","setMessages","_useState3","setErrors","_useState4","setInfos","_useState5","touched","setTouched","validations","update","data","initial","prevValue","nextValue","prevErrors","forEach","errName","current","nextError","prevInfos","infoName","nextInfo","prevTouched","nextTouched","useFormContext","componentValue","initialValue","_useState6","contextValue","setContextValue","formValue","useValue","createElement","event","persist","adjustedEvent","preventDefault","Provider","addValidation","validation","removeValidation","onBlur","get","set","displayName","FormDoc","process","env","NODE_ENV","require","doc","FormWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, useCallback, useEffect, useRef, useState } from 'react';\nimport { FormContext } from './FormContext';\nvar defaultMessages = {\n  invalid: 'invalid',\n  required: 'required'\n};\nvar defaultValue = {};\nvar defaultErrors = {};\nvar defaultInfos = {};\n\nvar updateErrors = function updateErrors(nextErrors, name, error) {\n  // we disable no-param-reassing so we can use this as a utility function\n  // to update nextErrors, to avoid code duplication\n\n  /* eslint-disable no-param-reassign */\n  var hasStatusError = typeof error === 'object' && error.status === 'error'; // typeof error === 'object' is implied for both cases of error with\n  // a status message and for an error object that is a react node\n\n  if (typeof error === 'object' && !error.status || hasStatusError || typeof error === 'string') {\n    nextErrors[name] = hasStatusError ? error.message : error;\n  } else {\n    delete nextErrors[name];\n  }\n  /* eslint-enable no-param-reassign */\n\n};\n\nvar updateInfos = function updateInfos(nextInfos, name, error) {\n  /* eslint-disable no-param-reassign */\n  if (typeof error === 'object' && error.status === 'info') {\n    nextInfos[name] = error.message;\n  } else {\n    delete nextInfos[name];\n  }\n  /* eslint-enable no-param-reassign */\n\n};\n\nvar Form = forwardRef(function (_ref, ref) {\n  var children = _ref.children,\n      _ref$errors = _ref.errors,\n      errorsProp = _ref$errors === void 0 ? defaultErrors : _ref$errors,\n      _ref$infos = _ref.infos,\n      infosProp = _ref$infos === void 0 ? defaultInfos : _ref$infos,\n      _ref$messages = _ref.messages,\n      messagesProp = _ref$messages === void 0 ? defaultMessages : _ref$messages,\n      onChange = _ref.onChange,\n      _onReset = _ref.onReset,\n      _onSubmit = _ref.onSubmit,\n      _ref$validate = _ref.validate,\n      validate = _ref$validate === void 0 ? 'submit' : _ref$validate,\n      valueProp = _ref.value,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"children\", \"errors\", \"infos\", \"messages\", \"onChange\", \"onReset\", \"onSubmit\", \"validate\", \"value\"]);\n\n  var _useState = useState(valueProp || defaultValue),\n      value = _useState[0],\n      setValue = _useState[1];\n\n  useEffect(function () {\n    if (valueProp !== undefined && valueProp !== value) {\n      setValue(valueProp);\n    }\n  }, [value, valueProp]);\n\n  var _useState2 = useState(messagesProp),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  useEffect(function () {\n    return setMessages(messagesProp);\n  }, [messagesProp]);\n\n  var _useState3 = useState(errorsProp || {}),\n      errors = _useState3[0],\n      setErrors = _useState3[1];\n\n  useEffect(function () {\n    return setErrors(errorsProp || {});\n  }, [errorsProp]);\n\n  var _useState4 = useState(infosProp || {}),\n      infos = _useState4[0],\n      setInfos = _useState4[1];\n\n  useEffect(function () {\n    return setInfos(infosProp || {});\n  }, [infosProp]);\n\n  var _useState5 = useState({}),\n      touched = _useState5[0],\n      setTouched = _useState5[1];\n\n  var validations = useRef({});\n  useEffect(function () {}, [value, errors, infos]);\n  var update = useCallback(function (name, data, initial) {\n    setValue(function (prevValue) {\n      var nextValue = _extends({}, prevValue);\n\n      nextValue[name] = data; // re-run any validations, in case the validation\n      // is checking across fields\n\n      setErrors(function (prevErrors) {\n        var nextErrors = _extends({}, prevErrors);\n\n        Object.keys(prevErrors).forEach(function (errName) {\n          if (validations.current[errName]) {\n            var nextError = validations.current[errName](data, nextValue);\n            updateErrors(nextErrors, errName, nextError);\n          }\n        });\n        return nextErrors;\n      });\n      setInfos(function (prevInfos) {\n        var nextInfos = _extends({}, prevInfos); // re-run any validations that have infos, in case the validation\n        // is checking across fields\n\n\n        Object.keys(nextInfos).forEach(function (infoName) {\n          if (validations.current[infoName]) {\n            var nextInfo = validations.current[infoName](data, nextValue);\n            updateInfos(nextInfos, infoName, nextInfo);\n          }\n        });\n        return nextInfos;\n      });\n      if (!initial && onChange) onChange(nextValue);\n      return nextValue;\n    });\n    if (!initial) setTouched(function (prevTouched) {\n      var nextTouched = _extends({}, prevTouched);\n\n      nextTouched[name] = true;\n      return nextTouched;\n    });\n  }, [onChange]); // There are three basic models of handling form input value state:\n  //\n  // 1 - form controlled\n  //\n  // In this model, the caller sets `value` and `onChange` propeties\n  // on the Form component to supply the values used by the input fields.\n  // In useFormContext(), componentValue would be undefined and formValue\n  // is be set to whatever the form state has. Whenever the form state\n  // changes, we update the contextValue so the input component will use\n  // that. When the input component changes, we will call update() to\n  // update the form state.\n  //\n  // 2 - input controlled\n  //\n  // In this model, the caller sets `value` and `onChange` properties\n  // on the input components, like TextInput, to supply the value for it.\n  // In useFormContext(), componentValue is this value and we ensure to\n  // update the form state, via update(), and set the contextValue from\n  // the componentValue. When the input component changes, we will\n  // call update() to update the form state.\n  //\n  // 3 - uncontrolled\n  //\n  // In this model, the caller doesn't set a `value` or `onChange` property\n  // at either the form or input component levels.\n  // In useFormContext(), componentValue is undefined and valueProp is\n  // undefined and nothing much happens here. That is, unless the\n  // calling component needs to know the state in order to work, such\n  // as CheckBox or Select. In this case, those components supply\n  // an initialValue, which will trigger updating the contextValue so\n  // they can have access to it.\n  //\n\n  var useFormContext = function useFormContext(name, componentValue, initialValue) {\n    var _useState6 = useState(initialValue),\n        contextValue = _useState6[0],\n        setContextValue = _useState6[1];\n\n    var formValue = name ? value[name] : undefined;\n    useEffect(function () {\n      if (name && componentValue !== undefined && componentValue !== formValue) // input drives\n        update(name, componentValue, formValue === undefined);\n    }, [componentValue, contextValue, formValue, initialValue, name]);\n    var useValue;\n    if (componentValue !== undefined) // input drives\n      useValue = componentValue;else if (valueProp && name && formValue !== undefined) // form drives\n      useValue = formValue;else useValue = contextValue;\n    return [useValue, function (nextValue) {\n      // only set if the input isn't driving\n      if (componentValue === undefined) {\n        if (name) update(name, nextValue);\n        if (initialValue !== undefined) setContextValue(nextValue);\n      }\n    }];\n  };\n\n  return React.createElement(\"form\", _extends({\n    ref: ref\n  }, rest, {\n    onReset: function onReset(event) {\n      if (!valueProp) {\n        setValue(defaultValue);\n        if (onChange) onChange(defaultValue);\n      }\n\n      setErrors({});\n      setTouched({});\n\n      if (_onReset) {\n        event.persist(); // extract from React's synthetic event pool\n\n        var adjustedEvent = event;\n        adjustedEvent.value = defaultValue;\n\n        _onReset(adjustedEvent);\n      }\n    },\n    onSubmit: function onSubmit(event) {\n      // Don't submit the form via browser form action. We don't want it\n      // if the validation fails. And, we assume a javascript action handler\n      // otherwise.\n      event.preventDefault();\n\n      var nextErrors = _extends({}, errors);\n\n      var nextInfos = _extends({}, infos);\n\n      Object.keys(validations.current).forEach(function (name) {\n        var nextError = validations.current[name](value[name], value);\n        updateErrors(nextErrors, name, nextError);\n        updateInfos(nextInfos, name, nextError);\n      });\n      setErrors(nextErrors);\n      setInfos(nextInfos);\n\n      if (Object.keys(nextErrors).length === 0 && _onSubmit) {\n        event.persist(); // extract from React's synthetic event pool\n\n        var adjustedEvent = event;\n        adjustedEvent.value = value;\n        adjustedEvent.touched = touched;\n\n        _onSubmit(adjustedEvent);\n      }\n    }\n  }), React.createElement(FormContext.Provider, {\n    value: {\n      addValidation: function addValidation(name, validation) {\n        validations.current[name] = validation;\n      },\n      removeValidation: function removeValidation(name) {\n        delete validations.current[name];\n      },\n      onBlur: validate === 'blur' ? function (name) {\n        if (validations.current[name]) {\n          var error = validations.current[name](value[name], value);\n          setErrors(function (prevErrors) {\n            var nextErrors = _extends({}, prevErrors);\n\n            updateErrors(nextErrors, name, error);\n            return nextErrors;\n          });\n          setInfos(function (prevInfos) {\n            var nextInfos = _extends({}, prevInfos);\n\n            updateInfos(nextInfos, name, error);\n            return nextInfos;\n          });\n        }\n      } : undefined,\n      errors: errors,\n      get: function get(name) {\n        return value[name];\n      },\n      infos: infos,\n      messages: messages,\n      set: function set(name, nextValue) {\n        return update(name, nextValue);\n      },\n      touched: touched,\n      update: update,\n      useFormContext: useFormContext,\n      value: value\n    }\n  }, children));\n});\nForm.displayName = 'Form';\nvar FormDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  FormDoc = require('./doc').doc(Form); // eslint-disable-line global-require\n}\n\nvar FormWrapper = FormDoc || Form;\nexport { FormWrapper as Form };"]},"metadata":{},"sourceType":"module"}